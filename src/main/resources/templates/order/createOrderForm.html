<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: header}" />
<style>
    .fieldError {
        border-color: #bd2130;
    }
</style>
<body>
<div class="container">
    <div th:replace="~{fragments/bodyHeader :: bodyHeader}"/>
    <form role="form" id="form" action="/order" method="post" th:object="${orderForm}">
        <div class="form-group">
            <label for="member">주문회원</label>
            <select th:field="*{memberId}" id="member" class="form-control"
                    th:class="${#fields.hasErrors('memberId')}? 'form-control fieldError' : 'form-control'">
                <option value="">회원선택</option>
                <option th:each="member : ${members}"
                        th:value="${member.memberId}"
                        th:text="${member.name}"/>
            </select>
            <p th:if="${#fields.hasErrors('memberId')}" th:errors="*{memberId}">Incorrect data</p>
        </div>
        <div class="form-group">
            <label for="item">상품명</label>
            <select th:field="*{itemId}" id="item" class="form-control"
                    th:class="${#fields.hasErrors('itemId')}? 'form-control fieldError' : 'form-control'">
                <option value="">상품선택</option>
                <option th:each="item : ${items}"
                        th:value="${item.itemId}"
                        th:text="${item.name}"/>
            </select>
            <p th:if="${#fields.hasErrors('itemId')}" th:errors="*{itemId}">Incorrect data</p>
        </div>
        <div class="form-group">
            <label for="count">주문수량</label>
            <input type="number" th:field="*{orderCount}" class="form-control" id="count" placeholder="주문 수량을 입력하세요">
        </div>
        <!--<button type="submit" class="btn btn-primary">Submit</button>-->
        <button type="button" class="btn btn-primary" onclick="doAction('submit')">Submit</button>
    </form>
    <br/>
    <div th:replace="~{fragments/footer :: footer}" />
</div> <!-- /container -->
<script>

    let form;

    document.addEventListener('DOMContentLoaded', () => {
        form = document.getElementById('form');
    });

    const checkValidate = () => {
        let flag = false;
        let count = document.getElementById("count").value;

        if (Number(count) <= 0 || count === "") {
            alert("수량은 0개 이상만 가능 합니다.");
            return false
        }

        return true;
    }

    function doAction(cmd, key) {
        if (cmd === 'submit') {
            if (checkValidate()) {
                form.submit();
            }
        }
    }


</script>
</body>
</html>